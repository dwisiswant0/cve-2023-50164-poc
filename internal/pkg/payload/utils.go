package payload

import (
	"os"

	"net/http"

	"github.com/brianvoe/gofakeit/v6"
	"github.com/carlmjohnson/requests"
)

func (pl *Payload) Upload(u string) error {
	return requests.URL(u).
		BodyBytes(pl.Bytes()).
		ContentType(pl.contentType).
		UserAgent(gofakeit.UserAgent()).
		Transport(http.DefaultTransport).
		Fetch(ctx)
}

func (pl *Payload) Check(u string, s int) error {
	return requests.URL(u).
		Path(pl.Path).
		Transport(http.DefaultTransport).
		CheckStatus(s).
		Fetch(ctx)
}

func (pl *Payload) Close() error {
	return os.RemoveAll(pl.tmpDir)
}
